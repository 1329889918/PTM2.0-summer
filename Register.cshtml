@model PTM2._0.ViewModels.RegisterViewModel
@{
    ViewData["Title"] = "用户注册";
}

<style>
    /* 淡蓝色主题样式 */
    :root {
        --primary-light: #e0f2fe;
        --primary: #90cdf4;
        --primary-dark: #3b82f6;
        --primary-gradient: linear-gradient(135deg, #90cdf4, #3b82f6);
        --text-primary: #1e40af;
    }

    body {
        background-color: #f8fafc;
        background-image: radial-gradient(circle at 20% 30%, rgba(144, 205, 244, 0.15) 0%, transparent 50%), radial-gradient(circle at 80% 70%, rgba(59, 130, 246, 0.15) 0%, transparent 50%);
        min-height: 100vh;
        display: flex;
        justify-content: center; /* 水平居中 */
        align-items: center; /* 垂直居中 */
        padding: 1rem;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .login-card {
        border: none;
        border-radius: 1.5rem;
        overflow: hidden;
        max-width: 500px; /* 减小卡片宽度 */
        width: 100%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    }

    .bg-gradient-primary {
        background: var(--primary-gradient);
    }

    .input-effect {
        transition: all 0.3s ease;
        border-color: #bfdbfe;
        border-radius: 0.75rem;
        height: 50px; /* 增加高度 */
        padding: 15px; /* 增加内边距 */
        font-size: 16px;
    }

        .input-effect:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 0.25rem rgba(59, 130, 246, 0.25);
            transform: translateY(-2px);
        }

    .btn-effect {
        transition: all 0.3s ease;
        font-weight: 500;
        border-radius: 0.75rem;
        padding: 12px 20px;
        font-size: 18px;
    }

        .btn-effect:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.2), 0 2px 4px -1px rgba(59, 130, 246, 0.1);
        }

    .btn-primary {
        background-color: #3b82f6;
        border-color: #3b82f6;
    }

        .btn-primary:hover {
            background-color: #2563eb;
            border-color: #2563eb;
        }

    .btn-outline-secondary {
        color: #3b82f6;
        border-color: #3b82f6;
    }

        .btn-outline-secondary:hover {
            background-color: #e0f2fe;
        }

    .invalid-feedback {
        display: block;
        margin-top: 0.25rem;
        font-size: 14px;
    }

    .card-body {
        padding: 30px; /* 调整内边距 */
    }

    .form-group {
        margin-bottom: 20px; /* 增加间距 */
    }

    .form-row {
        margin-bottom: 15px; /* 增加间距 */
    }


    .login-card {
        max-width: 95%;
    }

    .form-row {
        flex-direction: column;
    }

    .form-group.col-md-6 {
        width: 100%;
        margin-bottom: 15px;
    }

    }

    .header-icon {
        font-size: 24px;
        margin-right: 10px;
    }

    .form-floating {
        position: relative;
    }

        .form-floating label {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            padding: 1rem;
            pointer-events: none;
            transform-origin: 0 0;
            transition: all 0.2s ease;
            color: #6b7280;
        }

        .form-floating input:not(:placeholder-shown) ~ label,
        .form-floating input:focus ~ label {
            transform: translateY(-1.2rem) scale(0.8);
            opacity: 0.8;
        }

    .gender-label {
        display: block;
        margin-bottom: 8px;
        color: #374151;
        font-weight: 500;
    }

    .radio-container {
        display: flex;
        gap: 20px;
    }

    .form-check {
        display: flex;
        align-items: center;
    }

    .form-check-input {
        width: 18px;
        height: 18px;
        margin-right: 8px;
    }

    .form-check-label {
        font-size: 16px;
    }
</style>

<div class="container d-flex justify-content-center align-items-center">
    <div class="card login-card shadow-lg">
        <div class="card-header bg-gradient-primary text-white py-3">
            <h4 class="card-title text-center mb-0">
                <i class="fa fa-user-plus header-icon"></i>注册新账号
            </h4>
        </div>
        <div class="card-body">
            @if (TempData["RegisterError"] != null)
            {
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    @TempData["RegisterError"]
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            }

            <form asp-action="Register" method="post" class="needs-validation" novalidate>
                <div asp-validation-summary="All" class="text-danger mb-4"></div>

                <div class="form-row">
                    <div class="form-group col-md-6">
                        <div class="form-floating">
                            <input asp-for="Username" type="text" class="form-control input-effect" placeholder="请创建用户名" required style="width: 100%;">
                            <label asp-for="Username">用户名</label>
                            <span asp-validation-for="Username" class="invalid-feedback"></span>
                        </div>
                        <small id="usernameHelp" class="form-text text-muted">用户名长度必须在3-50个字符之间</small>
                    </div>
                    <div class="form-group col-md-6">
                        <div class="form-floating">
                            <input asp-for="Birthdate" type="date" class="form-control input-effect" required style="width: 100%;">
                            <label asp-for="Birthdate">出生日期</label>
                            <span asp-validation-for="Birthdate" class="invalid-feedback"></span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="form-floating">
                        <input asp-for="Address" type="text" class="form-control input-effect" placeholder="请输入居住地址" required style="width: 100%;">
                        <label asp-for="Address">居住地址</label>
                        <span asp-validation-for="Address" class="invalid-feedback"></span>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-6">
                        <div class="form-floating">
                            <input asp-for="Email" type="email" class="form-control input-effect" placeholder="请输入邮箱" required style="width: 100%;">
                            <label asp-for="Email">电子邮箱</label>
                            <span asp-validation-for="Email" class="invalid-feedback"></span>
                        </div>
                    </div>
                    <div class="form-group col-md-6">
                        <div class="form-floating">
                            <input asp-for="Phone" type="tel" class="form-control input-effect" placeholder="请输入电话" required style="width: 100%;">
                            <label asp-for="Phone">联系电话</label>
                            <span asp-validation-for="Phone" class="invalid-feedback"></span>
                            <small class="form-text text-muted">电话长度必须在11-15个字符之间</small>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="gender-label">性别</label>
                    <div class="radio-container">
                        <div class="form-check">
                            <input class="form-check-input input-effect" type="radio" asp-for="Gender" value="男" id="GenderMale" checked>
                            <label class="form-check-label" for="GenderMale">男</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input input-effect" type="radio" asp-for="Gender" value="女" id="GenderFemale">
                            <label class="form-check-label" for="GenderFemale">女</label>
                        </div>
                    </div>
                    <span asp-validation-for="Gender" class="invalid-feedback"></span>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-6">
                        <div class="form-floating">
                            <input asp-for="Password" type="password" class="form-control input-effect" placeholder="请设置密码" required style="width: 100%;">
                            <label asp-for="Password">登录密码</label>
                            <span asp-validation-for="Password" class="invalid-feedback"></span>
                            <small class="form-text text-muted">密码长度至少为6位</small>
                        </div>
                    </div>
                    <div class="form-group col-md-6">
                        <div class="form-floating">
                            <input asp-for="ConfirmPassword" type="password" class="form-control input-effect" placeholder="请确认密码" required style="width: 100%;">
                            <label asp-for="ConfirmPassword">确认密码</label>
                            <span asp-validation-for="ConfirmPassword" class="invalid-feedback"></span>
                        </div>
                    </div>
                </div>

                <div class="d-grid gap-2 mt-4">
                    <button type="submit" class="btn btn-primary btn-lg btn-effect">
                        <i class="fa fa-user-plus mr-2"></i>注册账号
                    </button>
                    <a asp-action="Index" class="btn btn-outline-secondary btn-lg btn-effect">
                        <i class="fa fa-sign-in mr-2"></i>返回登录
                    </a>
                </div>
            </form>
        </div>
        <div class="card-footer text-center py-3">
            <p class="mb-0">已有账号？<a asp-action="Index" class="text-primary fw-medium">立即登录</a></p>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // 表单验证增强
        $(function () {
            // 电话格式验证
            $("#Phone").blur(function () {
                var phone = $(this).val();
                if (phone.length > 0 && (phone.length < 11 || phone.length > 15)) {
                    $(this).next(".invalid-feedback").text("电话长度必须在11-15个字符之间").show();
                } else {
                    $(this).next(".invalid-feedback").text("").hide();
                }
            });

            // 密码匹配验证
            $("#ConfirmPassword").blur(function () {
                var password = $("#Password").val();
                var confirmPassword = $(this).val();

                if (password !== confirmPassword && password.length > 0) {
                    $(this).next(".invalid-feedback").text("两次输入的密码不一致").show();
                } else {
                    $(this).next(".invalid-feedback").text("").hide();
                }
            });

            // 用户名实时检查
            $("#Username").blur(function () {
                if ($(this).val().length >= 3) {
                    $.get("/Login/CheckUsernameExists", { username: $(this).val() }, function (result) {
                        if (!result) {
                            $("#Username").next(".invalid-feedback").text("用户名已存在").show();
                        } else {
                            $("#Username").next(".invalid-feedback").text("").hide();
                        }
                    });
                }
            });

            // 表单验证
            (function () {
                'use strict';
                window.addEventListener('load', function () {
                    var forms = document.getElementsByClassName('needs-validation');
                    var validation = Array.prototype.filter.call(forms, function (form) {
                        form.addEventListener('submit', function (event) {
                            if (!form.checkValidity()) {
                                event.preventDefault();
                                event.stopPropagation();
                            }
                            form.classList.add('was-validated');
                        }, false);
                    });
                }, false);
            })();
        });
    </script>
}